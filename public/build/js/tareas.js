!function(){!async function(){try{const t="/api/tareas?url="+d(),o=await fetch(t),n=await o.json();e=n.tareas,a(),console.log(e)}catch(e){console.log(e)}}();let e=[],t=[];document.querySelector(".boton-formulario").addEventListener("click",(function(){n(!1)}));function o(o){const n=o.target.value;t=""!==n?e.filter(e=>e.estado===n):[],a()}function a(){!function(){const e=document.querySelector("#listado-tareas");for(;e.firstChild;)e.removeChild(e.firstChild)}(),function(){const t=e.filter(e=>"0"===e.estado),o=document.querySelector("#pendientes");0===t.length?o.disabled=!0:o.disabled=!1}(),function(){const t=e.filter(e=>"1"===e.estado),o=document.querySelector("#completadas");0===t.length?o.disabled=!0:o.disabled=!1}();const o=t.length?t:e;if(0===o.length){const e=document.querySelector("#listado-tareas"),t=document.createElement("LI");return t.textContent="No hay Tareas",t.classList.add("no-tareas"),void e.appendChild(t)}const r={0:"Pendiente",1:"Completa"};o.forEach(t=>{const o=document.createElement("LI");o.dataset.tareaId=t.id,o.classList.add("tarea");const s=document.createElement("P");s.textContent=t.nombre,s.ondblclick=function(){n(!0)};const i=document.createElement("DIV");i.classList.add("opciones");const l=document.createElement("BUTTON");l.classList.add("btn","estado-tarea"),l.classList.add(""+r[t.estado].toLowerCase()),l.textContent=r[t.estado],l.dataset.estadoTarea=t.estado,l.ondblclick=function(){!function(t){console.log(t);const o="1"===t.estado?"0":"1";t.estado=o,async function(t){const{estado:o,id:n,nombre:r,proyectoId:s}=t,i=new FormData;i.append("id",n),i.append("nombre",r),i.append("estado",o),i.append("proyectoId",d());try{const t="http://localhost:3000/api/tarea/actualizar",d=await fetch(t,{method:"POST",body:i}),r=await d.json();"exito"===r.respuesta.tipo&&(c(r.respuesta.mensaje,r.respuesta.tipo,document.querySelector(".contenedor-nueva-tarea")),e=e.map(e=>(e.id===n&&(e.estado=o),e)),a())}catch(e){console.log(e)}}(t)}({...t})},"0"===t.estado?l.classList.add("btn-warning"):"1"===t.estado&&l.classList.add("btn-primary");const u=document.createElement("BUTTON");u.classList.add("eliminar-tarea"),u.classList.add("btn","btn-danger"),u.dataset.idTarea=t.id,u.textContent="Eliminar",u.onclick=function(){!function(t){Swal.fire({title:"Eliminar Tarea?",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(o=>{o.isConfirmed&&(console.log("elimanando...."),async function(t){const{estado:o,id:n,nombre:c}=t,r=new FormData;r.append("id",n),r.append("nombre",c),r.append("estado",o),r.append("proyectoId",d());try{const o="http://localhost:3000/api/tarea/eliminar",n=await fetch(o,{method:"POST",body:r}),c=await n.json();c.resultado&&(swal.fire("Eliminado!",c.mensaje,"success"),e=e.filter(e=>e.id!==t.id),a())}catch(e){}}(t))})}({...t})},i.appendChild(l),i.appendChild(u),o.appendChild(s),o.appendChild(i);document.querySelector("#listado-tareas").appendChild(o)})}function n(e=!1){$("#modalAgregarTarea").modal("show"),console.log(e)}document.querySelectorAll('#filtros input[type="radio"').forEach(e=>{e.addEventListener("input",o)});function c(e,t,o){const a=document.querySelector(".alerta");a&&a.remove();const n=document.createElement("DIV");n.classList.add("alerta",t),n.textContent=e,o.parentElement.insertBefore(n,o),console.log(n),setTimeout(()=>{n.remove()},5e3)}function d(){const e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries()).url}document.querySelector(".boton-tarea").addEventListener("click",()=>{!function(){const t=document.querySelector("#tarea").value.trim();if(""===t)return void c("El nombre de la tarea es Obligatorio","errores",document.querySelector(".modal-body label"));!async function(t){const o=new FormData;o.append("nombre",t),o.append("proyectoId",d());try{const n="http://localhost:3000/api/tarea",d=await fetch(n,{method:"POST",body:o}),r=await d.json();console.log(r),c(r.mensaje,r.tipo,document.querySelector(".modal-body label")),"exito"===r.tipo&&setTimeout(()=>{$("#modalAgregarTarea").modal("hide");const o={id:String(r.id),nombre:t,estado:"0",proyectoId:r.proyectoId};e=[...e,o],a()},2e3)}catch(e){}}(t)}()})}();